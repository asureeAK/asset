<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DC Dispatch & FMG Ticket</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            background: linear-gradient(120deg, #f4f8fc 0%, #e9ecf7 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 700px;
            margin: 40px auto;
            background: #fff;
            border-radius: 18px;
            box-shadow: 0 4px 24px #0002;
            padding: 38px 32px 32px 32px;
        }
        h1 { font-size: 2.1em; margin-bottom: 18px; color: #1a287a; }
        .subtitle { font-size: 1.15em; color: #395074; margin-bottom: 30px; }
        label { display:block; margin-top: 13px; font-weight: 500; color: #244d6e;}
        input[type="text"], textarea {
            width: 100%; border-radius: 6px; padding: 7px 12px; font-size: 1em;
            border: 1px solid #b4bbd1; margin-top:6px;
        }
        table { width: 100%; border-collapse: collapse; margin: 12px 0 18px 0;}
        th, td { border: 1px solid #cfe0ef; padding: 8px; text-align: center;}
        th { background: #e7ecfa;}
        button { background: #245ed8; color: #fff; border: none; border-radius: 7px;
            padding: 9px 18px; font-size: 1.07em; font-weight: 600; cursor: pointer; margin-top: 18px; margin-bottom: 8px;
            transition: background 0.2s;
        }
        button:hover { background: #193e99; }
        .delete-btn { color: #d23535; background: none; border: none; font-size:1em; padding:0; cursor: pointer; }
        .preview-section {
            background: #f6faff;
            border-radius: 10px;
            border: 1px solid #e3eaf7;
            padding: 22px 19px;
            margin-top: 38px;
        }
        h2 { font-size: 1.18em; color: #144a9a; margin-top: 16px;}
        .card { background:#f0f6fc; border:1px solid #dbe7f7; border-radius:13px; box-shadow:0 2px 8px #d9e1ee; margin-bottom:18px;padding:24px 15px;}
        .asset-sentence { margin-bottom: 14px; display: block; color: #000; font-weight: 500;}
        @media (max-width:740px) {
            .container { max-width: 99vw; padding: 10vw 3vw;}
            table th, table td { padding:6px;}
        }
    </style>
</head>
<body>
<div class="container">
    <div class="card">
        <h1>DC Dispatch & FMG Ticket</h1>
        <div class="subtitle">Dispatch multiple assets and automatically generate ticket mail content</div>
        <label>Destination Location:</label>
        <input type="text" id="location" placeholder="Eg: Chennai office">
        <label>IT Person Name:</label>
        <input type="text" id="itPerson" placeholder="Eg: Ravi Kumar">
        <label>DC Number Link (URL):</label>
        <input type="text" id="dcLink" placeholder="Eg: https://yourcompany/dc/12345">
        <label>FMG Ticket Link 1:</label>
        <input type="text" id="ticket1" placeholder="Eg: https://yourcompany.atlassian.net/browse/FMGTKT-9509">
        <label>FMG Ticket Link 2:</label>
        <input type="text" id="ticket2" placeholder="(optional)">
        <div style="margin-top:10px;">
            <strong>Assets to Dispatch</strong>
            <table id="assetTable">
                <thead>
                    <tr>
                        <th>Asset Name</th>
                        <th>Asset Tag</th>
                        <th>Serial No</th>
                        <th>Charger Name</th>
                        <th>Charging Adapter</th>
                        <th>Bag</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <button type="button" onclick="addAssetRow()">+ Add Asset</button>
        </div>
        <button type="button" onclick="updatePreview()">Show Preview</button>
    </div>
    <div class="preview-section card">
        <h2>Dispatch Preview</h2>
        <div id="dispatchPreview"></div>
        <h2>FMG Ticket Preview</h2>
        <div id="fmgPreview"></div>
    </div>
</div>
<script>
function addAssetRow() {
    let tbody = document.getElementById('assetTable').querySelector('tbody');
    let row = tbody.insertRow();
    row.innerHTML =
        `<td><input type="text" placeholder="Asset Name"></td>
         <td><input type="text" placeholder="Asset Tag"></td>
         <td><input type="text" placeholder="Serial No"></td>
         <td><input type="text" placeholder="Charger Name"></td>
         <td><input type="checkbox" class="adapterCheckbox" checked title="Include Charging Adapter"></td>
         <td><input type="checkbox" class="bagCheckbox"></td>
         <td><button class="delete-btn" onclick="deleteRow(this)">&#10006;</button></td>`;
}
function deleteRow(btn) { btn.closest('tr').remove(); updatePreview(); }
function getAssets() {
    let rows = [...document.querySelectorAll('#assetTable tbody tr')];
    let assets = [];
    rows.forEach(row => {
        let cells = row.querySelectorAll('input');
        if (
            (cells[0].value || cells[1].value || cells[2].value || cells[3].value)
        ) {
            assets.push({
                name: cells[0].value.trim(),
                tag: cells[1].value.trim(),
                serial: cells[2].value.trim(),
                charger: cells[3].value.trim(),
                withAdapter: cells[4].checked,
                withBag: cells[5].checked
            });
        }
    });
    return assets;
}
function assetSummarySentences(assets, location) {
    return assets.map(asset => {
        let acc = [];
        if(asset.withAdapter) acc.push(asset.charger ? asset.charger : "charging adapter");
        if(asset.withBag) acc.push("bag");
        let desc = acc.length ? " along with its " + acc.join(" and ") : "";
        return `<span class="asset-sentence">Dispatching the ${asset.name}${desc} to ${location}.</span>`;
    }).join("");
}
function assetSummaryRows(assets) {
    let rows = "";
    assets.forEach(asset => {
        // Main asset row
        rows += `<tr>
            <td>${asset.name}</td>
            <td>${asset.serial}</td>
            <td>${asset.tag}</td>
        </tr>`;
        // Accessories rows:
        if(asset.withAdapter) {
            rows += `<tr>
            <td>${asset.charger ? asset.charger : "Charging Adapter"}</td>
            <td>-</td><td>-</td>
            </tr>`;
        }
        if(asset.withBag) {
            rows += `<tr>
            <td>Bag</td><td>-</td><td>-</td>
            </tr>`;
        }
    });
    return rows;
}
function renderMailContent(assets, location, dcLink, itPerson) {
    let dcNumber = dcLink ? `DC Link: <a href="${dcLink}" target="_blank">${dcLink}</a>` : "";
    let assetRows = assetSummaryRows(assets);
    let sentences = assetSummarySentences(assets, location);

    return `
<div style="margin-bottom:22px;"><strong>Hi Team,</strong></div>
${sentences}
<div style="margin-bottom:18px;"><strong>Please confirm once you have received the following assets.</strong></div>
${dcNumber}
<br><br><strong>Asset Details:</strong><br>
<table style="margin-bottom:12px;">
<thead>
    <tr>
        <th>Asset Name</th>
        <th>Serial No</th>
        <th>Asset Tag</th>
    </tr>
</thead>
<tbody>
${assetRows}
</tbody>
</table>
<br><br><div><strong>Regards,<br>${itPerson ? itPerson : "<IT Person Name>"}</strong></div>
    `;
}
function renderFMGContent(assets, location, ticket1, ticket2) {
    let ticketLinks = ticket1 ? `<a href="${ticket1}" target="_blank">${ticket1}</a>` : "";
    ticketLinks += ticket2 ? `,<br><a href="${ticket2}" target="_blank">${ticket2}</a>` : "";
    let assetRows = assetSummaryRows(assets);

    return `
<div style="margin-bottom:24px;"><strong>FMG Ticket content:</strong></div>
${ticketLinks ? `[${ticketLinks} (ref)]<br><br>` : ""}
<div style="margin-bottom:18px;"><strong>Dispatched Assets:</strong></div>
<table style="margin-bottom:12px;">
<thead>
    <tr>
        <th>Asset Name</th>
        <th>Serial No</th>
        <th>Asset Tag</th>
    </tr>
</thead>
<tbody>
${assetRows}
</tbody>
</table>
<div style="margin-bottom:16px;"><strong>Destination:</strong> ${location ? location : '-'}</div>
<div style="margin-bottom:16px;"><strong>Description</strong></div>
<div style="margin-bottom:16px;"><strong>Hi Team,</strong></div>
Please arrange for the courier of the above assets to ${location}
    `;
}
function updatePreview() {
    let location = document.getElementById('location').value.trim();
    let dcLink = document.getElementById('dcLink').value.trim();
    let itPerson = document.getElementById('itPerson').value.trim();
    let ticket1 = document.getElementById('ticket1').value.trim();
    let ticket2 = document.getElementById('ticket2').value.trim();
    let assets = getAssets();

    document.getElementById('dispatchPreview').innerHTML = renderMailContent(assets, location, dcLink, itPerson);
    document.getElementById('fmgPreview').innerHTML = renderFMGContent(assets, location, ticket1, ticket2);
}
addAssetRow();
updatePreview();
</script>
</body>
</html>
