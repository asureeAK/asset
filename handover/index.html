<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Asset Handover Form</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            background: linear-gradient(130deg, #eae8ff 0%, #deeafb 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 740px;
            margin: 40px auto;
            background: #fff;
            border-radius: 18px;
            box-shadow: 0 4px 24px #6869bb44;
            padding: 36px 30px 32px 32px;
        }
        h1 {
            font-size: 2.1em;
            margin-bottom: 17px;
            color: #5249d2;
            letter-spacing: .04em;
        }
        .subtitle {
            font-size: 1.15em;
            color: #506abf;
            margin-bottom: 28px;
        }
        label {display:block; margin-top:13px; font-weight:500; color: #4f5ca6;}
        input[type="text"], textarea {
            width: 100%; border-radius: 6px; padding: 7px 12px; font-size: 1em;
            border: 1px solid #aeb4ee; margin-top:6px;
        }
        table {width:100%; border-collapse: collapse; margin:14px 0 19px 0;}
        th, td {border:1px solid #bfcbee; padding:8px; text-align:center; vertical-align: top;}
        th {background: #e7eaff; color: #473ace;}
        tr:nth-child(even) {background: #f4f6ff;}
        button {
            background: #6456f0; color: #fff; border: none; border-radius: 7px;
            padding: 9px 18px; font-size: 1.07em; font-weight: 600; cursor: pointer;
            margin-top: 18px; margin-bottom: 8px; transition: background 0.2s;
        }
        button:hover { background: #3719b2; }
        .delete-btn {
            color: #d23535; background: none; border: none; font-size:1em; padding:0; cursor: pointer;
        }
        .preview-section {
            background: #f6faff;
            border-radius: 10px;
            border: 1px solid #d2d5f1;
            padding: 25px 22px;
            margin-top: 38px;
            box-shadow:0 3px 12px #6e78ae29;
        }
        h2 { font-size: 1.16em; color: #6056be; margin-top: 12px;}
        .card {background:#edf0ff; border:1px solid #dee6f8; border-radius:13px; box-shadow:0 2px 8px #d7d3f1; margin-bottom:18px;padding:24px 15px;}
        ul {margin-top: 1em; margin-bottom: 1em;}
        @media (max-width:780px) {
            .container { max-width: 99vw; padding: 8vw 3vw;}
            table th, table td { padding:6px;}
        }
    </style>
</head>
<body>
<div class="container">
    <div class="card">
        <h1>Asset Handover Form</h1>
        <div class="subtitle">Hand over and allocate assets with full accessory tracking</div>
        <label>Relieved Employee:
            <input type="text" id="relievedEmployee">
        </label><br>
        <label>Asset Assigned Person:
            <input type="text" id="assignedPerson">
        </label><br>
        <div><strong>Assets Returned</strong></div>
        <table id="assetsTable">
            <thead>
                <tr>
                    <th>Asset Name</th>
                    <th>Asset Tag</th>
                    <th>Serial No</th>
                    <th>Charging Adapter</th>
                    <th>Bag</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
        <button type="button" onclick="addAssetRow()">+ Add Asset</button>
        <div><strong>Assets Allocated</strong></div>
        <table id="assignmentsTable">
            <thead>
                <tr>
                    <th>Asset Name</th>
                    <th>Asset Tag</th>
                    <th>Serial No</th>
                    <th>Charging Adapter</th>
                    <th>Bag</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
        <button type="button" onclick="addAssignmentRow()">+ Add Allocated Asset</button>
        <div>General Comments (optional):</div>
        <textarea id="comments" rows="2"></textarea>
        <br>
        <label>IT Member Name:
            <input type="text" id="itMember">
        </label>
        <br>
        <button type="button" onclick="updatePreview()">Show Preview</button>
    </div>
    <div class="preview-section card">
        <h2>Preview Email</h2>
        <div id="emailPreview"></div>
    </div>
</div>
<script>
function addAssetRow() {
    let tbody = document.getElementById('assetsTable').querySelector('tbody');
    let row = tbody.insertRow();
    row.innerHTML =
        `<td><input type="text" placeholder="Asset Name"></td>
         <td><input type="text" placeholder="Asset Tag"></td>
         <td><input type="text" placeholder="Serial No"></td>
         <td><input type="checkbox" class="withAdapter" onclick="updatePreview()" checked></td>
         <td><input type="checkbox" class="withBag" onclick="updatePreview()" checked></td>
         <td><button class="delete-btn" onclick="deleteRow(this)">&#10006;</button></td>`;
}
function addAssignmentRow() {
    let tbody = document.getElementById('assignmentsTable').querySelector('tbody');
    let row = tbody.insertRow();
    row.innerHTML =
        `<td><input type="text" placeholder="Asset Name"></td>
         <td><input type="text" placeholder="Asset Tag"></td>
         <td><input type="text" placeholder="Serial No"></td>
         <td><input type="checkbox" class="withAdapter" onclick="updatePreview()" checked></td>
         <td><input type="checkbox" class="withBag" onclick="updatePreview()" checked></td>
         <td><button class="delete-btn" onclick="deleteRow(this)">&#10006;</button></td>`;
}
function deleteRow(btn) { btn.closest('tr').remove(); updatePreview(); }
function getTableData(tableId) {
    let rows = document.querySelectorAll(`#${tableId} tbody tr`);
    let data = [];
    rows.forEach(row => {
        let cells = row.querySelectorAll('input');
        if (
            cells.length >= 5 &&
            (cells[0].value||cells[1].value||cells[2].value)
        ) {
            data.push({
                name: cells[0].value,
                tag: cells[1].value,
                serial: cells[2].value,
                withAdapter: cells[3].checked,
                withBag: cells[4].checked
            });
        }
    });
    return data;
}
function renderRetTable(rows) {
    let html = `<table class="email-table"><thead>
      <tr><th>Asset Name</th><th>Asset Tag</th><th>Serial No</th></tr></thead><tbody>`;
    rows.forEach(r => {
        html += `<tr><td>${r.name}</td><td>${r.tag}</td><td>${r.serial}</td></tr>`;
        if (r.withAdapter) {
            html += `<tr><td>Charging Adapter</td><td>-</td><td>-</td></tr>`;
        }
        if (r.withBag) {
            html += `<tr><td>Bag</td><td>-</td><td>-</td></tr>`;
        }
    });
    html += "</tbody></table>";
    return html;
}
function renderAllocTable(rows) {
    let html = `<table class="email-table"><thead>
        <tr>
            <th>Asset Name</th>
            <th>Asset Tag</th>
            <th>Serial No</th>
        </tr>
    </thead><tbody>`;
    rows.forEach(r => {
        html += `<tr><td>${r.name}</td><td>${r.tag}</td><td>${r.serial}</td></tr>`;
        if (r.withAdapter) {
            html += `<tr><td>Charging Adapter</td><td>-</td><td>-</td></tr>`;
        }
        if (r.withBag) {
            html += `<tr><td>Bag</td><td>-</td><td>-</td></tr>`;
        }
    });
    html += "</tbody></table>";
    return html;
}
function getStatusPhrase(adapter, bag) {
    let phrases = [];
    phrases.push(adapter ? "with charging adapter" : "without charging adapter");
    phrases.push(bag ? "with bag" : "without bag");
    return phrases.join(" and ");
}
function getItemComment(asset, person, action) {
    let status = getStatusPhrase(asset.withAdapter, asset.withBag);
    return `- I ${action} the ${asset.name} ${status} ${action==='received' ? 'from' : 'to'} ${person}.`;
}
function updatePreview() {
    let relieved = document.getElementById('relievedEmployee').value.trim();
    let assigned = document.getElementById('assignedPerson').value.trim();
    let itMember = document.getElementById('itMember').value.trim();
    let comments = document.getElementById('comments').value.trim();
    let returnedAssets = getTableData('assetsTable');
    let assignedAssets = getTableData('assignmentsTable');

    let html = `<div><strong>Subject:</strong> Asset Handover${relieved ? ' – ' + relieved : ''}</div><br><br>`;
    html += `<div>Hi Team,<br><br></div>`;

    if(relieved && returnedAssets.length) {
        html += `I have received the following assets from <strong>${relieved}</strong>:<br><br>`;
        html += renderRetTable(returnedAssets) + "<br>";
    }
    if(relieved && !returnedAssets.length) {
        html += `This is to confirm that <strong>${relieved}</strong> has completed asset handover.<br><br>`;
    }

    if(assigned && assignedAssets.length) {
        html += `<br><strong>Assets Allocated – ${assigned}</strong><br>`;
        html += renderAllocTable(assignedAssets) + "<br>";
    }

    if(comments) {
        html += `<br><strong>General Comments:</strong> ${comments}<br><br>`;
    }
    html += `<br>Regards,<br>${itMember ? itMember : "<SNMG Member Name>"}<br><br>`;
    html += `<br><br><strong>Item Summary:</strong><br><ul>`;
    returnedAssets.forEach(function(asset){
        html += `<li style="margin-bottom:12px;">${getItemComment(asset, relieved, "received")}</li>`;
    });
    assignedAssets.forEach(function(asset){
        html += `<li style="margin-bottom:12px;">${getItemComment(asset, assigned, "allocated")}</li>`;
    });
    html += `</ul>`;
    document.getElementById('emailPreview').innerHTML = html;
}
addAssetRow();
addAssignmentRow();
updatePreview();
</script>
</body>
</html>
